<div class="dataPlugData">
  <nav class="nav">
    <a (click)="currentPage = 'feed'" [class.current]="currentPage == 'feed'">Feed</a>
    <a (click)="currentPage = 'static'" [class.current]="currentPage == 'static'" *ngIf="staticData.length > 0">Static data</a>
  </nav>


  <div class="feed" *ngIf="currentPage == 'feed'">
    <div class="header">
      <img *ngIf="plugMeta" [src]="'assets/icons/' + plugMeta.name.toLowerCase() + '-plug.svg'" />
      <div>
        <h3>{{ plugName }} feed</h3>
        <p>All the posts stored in this data plug</p>
      </div>
    </div>

    <div class="dates">
      <!--<div class="fromDatePicker datePicker">-->
        <!--<label for="fromDate">From</label>-->
        <!--<input id="fromDate" name="fromDate" type="date" (change)="setFromDate($event)">-->
      <!--</div>-->

      <!--<div class="toDatePicker datePicker">-->
        <!--<label for="toDate">To</label>-->
        <!--<input id="toDate" name="toDate" type="date" [value]="toDate.format('YYYY-MM-DD')" (change)="setToDate($event)">-->
      <!--</div>-->
    </div>

    <ul class="nav nav-tabs">
      <li *ngIf="locations.length > 0" [class.active]="tabView == 'locations'"><a (click)="tabView = 'locations'; resizeWindow()">Map view</a></li>
      <li *ngIf="feed.length > 0" [class.active]="tabView == 'posts'"><a (click)="tabView = 'posts'">Posts</a></li>
      <li *ngIf="events.length > 0" [class.active]="tabView == 'events'"><a (click)="tabView = 'events'">Events</a></li>
    </ul>

    <div class="feedItems" *ngIf="feed && feed.length" [class.hidden]="tabView !== 'posts'">
      <div class="item" *ngFor="let item of feed">
        <rum-facebook-view *ngIf="plugName.toLowerCase() == 'facebook'" [item]="item"></rum-facebook-view>
        <rum-twitter-view *ngIf="plugName.toLowerCase() == 'twitter'" [item]="item"></rum-twitter-view>
        <rum-locations-view *ngIf="plugName.toLowerCase() == 'locations'" [item]="item"></rum-locations-view>
        <rum-notables-view *ngIf="plugName.toLowerCase() == 'rumpel'" [item]="item"></rum-notables-view>
        <rum-calendar-view *ngIf="plugName.toLowerCase() == 'fitbit'" [item]="item"></rum-calendar-view>
      </div>

      <div class="loadMore">
        <p class="meta">Showing {{ feed.length }} results</p>
        <a class="btn btn-default" (click)="loadMoreFeedData()">Load more</a>
      </div>
    </div>

    <div class="mapView" [class.hidden]="tabView !== 'locations'">
      <rum-map *ngIf="locations.length > 0" [mapHeight]="'400px'" [dataPoints]="locations" [enableMapControls]="true">
        <!--<div class="loading-overlay">-->
          <!--<rum-spinner [isRunning]="true"></rum-spinner>-->
          <!--<span>Loading more data...</span>-->
        <!--</div>-->
      </rum-map>
      <div class="loadMore">
        <p class="meta">Showing {{ feed.length }} results</p>
        <a class="btn btn-default" (click)="loadMoreFeedData()">Load more</a>
      </div>
    </div>

    <div class="calendarView" [class.hidden]="tabView !== 'events'">
      <div class="item" *ngFor="let event of events">
        <rum-facebook-event-view *ngIf="events.length > 0 && plugName.toLowerCase() === 'facebook'" [item]="event"></rum-facebook-event-view>
        <rum-photos-view *ngIf="events.length > 0 && plugName.toLowerCase() === 'fitbit'" [item]="event"></rum-photos-view>
      </div>
      <div class="loadMore">
        <p class="meta">Showing {{ events.length }} results</p>
        <a class="btn btn-default" (click)="loadMoreEventData()">Load more</a>
      </div>
    </div>

  </div>

  <div class="static" *ngIf="currentPage == 'static'">
    <div class="header">
      <img *ngIf="plugMeta" [src]="'assets/icons/' + plugMeta.name.toLowerCase() + '-plug.svg'" />
      <div>
        <h3>{{ plugName }} static data</h3>
        <p>All the personal data stored in this data plug</p>
      </div>
    </div>

    <table *ngIf="staticData.length > 0">
      <tr *ngFor="let static of staticData">
        <td>{{ static.name }}</td>
        <td>{{ static.value }}</td>
      </tr>
    </table>
  </div>
</div>
